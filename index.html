<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Walltaker Viewer</title>
</head>
<body>
    <img id="image" src="">
    <video autoplay loop id="video" src=""></video>
    <style>
        body {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
            background-color: #1e1e1e;
        }

        #image, #video {
            max-width: 100vw;
            max-height: 100vh;
        }
        </style>
        <script>
            (async () => {
                const updatePage = async (id) => {
                    let response = await fetch(`https://walltaker.joi.how/api/links/${id}.json`);
                    let data = await response.json();
                    let url = data['post_url'];
            
                    if (url.endsWith('.webm')) {
                        document.getElementById('video').src = url;
                        document.getElementById('image').src = '';
                    } else {
                        document.getElementById('image').src = url;
                        document.getElementById('video').src = '';
                    }
                };
            
                let id = window.location.hash.substring(1);
                if (!id) {
                    alert('bad hash fragment. the url should have "#your_id_here" at the end.');
                } else {
                    updatePage(id);
                    setInterval(() => updatePage(id), 60000);
                }
            })();
        </script>
</body>
</html>
